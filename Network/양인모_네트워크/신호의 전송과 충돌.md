# 1계층

통신 매체(케이블)에 데이터를 보내는 것과 그 데이터가 지나는 것에 대한 순서와 규칙으로 케이블이 연결되어 있는 기기에 신호를 전달한다.

## 1계층이 정하는 것

- 신호 (아날로그 신호, 디지털 신호)
- 인터페이스 (NIC, DCE)
- 케이블 (UTP, 광케이블 등)

### 신호에 발생하는 문제

전기 신호는 '감쇠', '노이즈', '충돌' 등이 발생하면 바르게 읽을 수 없다.

# 2계층

신호가 닿는 범위인 세그먼트 내에서의 데이터 전송에 관한 규정

신호를 보내기 위한 순서와 신호가 도달한 후의 순서를 정의한다.
1계층에서 사용되고 있는 케이블이나 신호에 따라 규칙이 다르다. 대표적으로 LAN과 WAN용으로 나뉜다. 3계층 이상의 계층은 LAN, WAN 구분없이 동일한 규칙을 사용한다.

## 허브

허브에 케이블로 연결되어 있는 기기는 하나의 케이블에 연결되어 있는 것과 같다.

### 기능

- 신호의 증폭과 재생

  감쇠에 의해 붕괴된 신호를 본래의 형태로 증폭, 재생해 멀리까지 신호를 전달한다.

- 네트워크 구축

  여러 기기를 연결해서 네트워크를 구축한다. 허브에 연결되어 있는 기기들은 신호를 주고받을 수 있다.

- 연속 접속

  허브와 허브를 연결해 신호가 도달하는 범위가 넓어진다.

#### 단점

- 플러딩

  허브는 들어오는 신호를 제어하지 않는다. 수신한 포트 이외의 모든 포트에 수신한 신호를 송신한다. 이 현상을 `flooding`이라 한다. 그래서 허브에 연결되어 있는 2대 이상의 기기가 동시에 신호를 보내면 충돌이 일어날 가능성이 있다.

- 충돌 도메인

  허브로 연결되어 있어 신호를 송신하면 충돌이 발생할지도 모르는 범위

### 세그먼트 범위

멀티액세스 네트워크라면 허브에 의해 연결되어 있는 범위를 의미한다.

포인트 투 포인트 네트워크라면 컴퓨터와 라우터, 라우터와 라우터의 범위를 의미한다.

### 프레이밍

송수신되는 비트열에 의미를 주어 데이터로 취급하는 과정

프리엠블 신호를 수신하면 프레임 신호가 온다고 판단한다.

#### 프리엠블

지금부터 프레임이 시작된다는 신호

##### 신호의 동기

송신 측과 수신측의 타이밍이 어긋나면 신호를 읽을 수 없다. 그래서 통신 직전에 프리엠블을 보내 타이밍을 맞춰야 한다.

## 2계층 데이터 송수신 방법

- 유니캐스트

  1대1 통신, 특정 대상에게 메시지를 보내는 통신

  모든 기기는 유일한 유니캐스트 주소를 1개 이상 가진다.

- 브로드 캐스트

  1대 전체, 모두에게 메시지를 보내는 통신

- 멀티 캐스트

  1대 다수, 지정된 그룹(복수의 기기)로 메시지를 보내는 통신

### MAC 주소

인터페이스에 지정된 고정 주소, 48비트 값으로 앞의 24 비트는 인터페이스를 제조한 회사의 번호(벤더코드)고 뒤의 24비트는 회사가 붙인 할당 번호(벤더 할당 코드)이다.

### 이더넷 프레임

이더넷에서 사용하는 2계층 PDU

- 이더넷

  2계층에서 사용하는 프로토콜

- PDU 구성

  ```
  |--------------헤더-------------|         |-------트레일러------|
  수신처 MAC주소 송신처 MAC주소 타입 페이로드 FCS(에러 체크용 비트열)
  ```

통신 도중에 에러가 발생하면 파기한다.

#### 동작

허브에 의해 모든 기기에 도달한 프레임은 수신처 MAC 주소를 가진 기기 이외에는 파기한다.

1. 송신 컴퓨터가 유니캐스트로 프레임을 송신하면 모든 기기에 도달한다.
2. 수신한 프레임의 수신처 MAC 주소가 자신의 MAC 주소가 아닌 컴퓨터는 프레임을 파기한다.

### CSMA/CD

신호를 보내는 타이밍을 겹치지 않게 해 충돌이 일어나지 않도록 제어하는 방식

- CS

  신호감지를 의미, 누군가가 송신 중이라면 송신하지 않는다.

- MA

  다중액세스를 의미, 아무도 송신하고 있지 않다면 송신할 수 있다.

- CD

  충돌검사를 의미, 송신 후에 충돌이 일어나면 다시 재수행한다.

## 스위치

신호의 충돌은 케이블이 아니라 허브에서 발생한다.
그래서 신호가 지나는 길을 나누기 위한 기기인 스위치를 허브 대신 사용한다.
스위치는 수신한 프레임을 MAC주소 필터링과 버퍼링으로 처리해 충돌을 막는다.

### MAC 주소 필터링

수신한 프레임의 송신처 MAC 주소를 기록해 수신한 포트랑 MAC 주소를 연결시킨다.

1. 통신과정이 끝나면 포트에 연결되어 있는 컴퓨터의 MAC주소를 스위치의 `MAC Address Table`에 기록한다.
2. 스위치에 프레임이 도달한 경우 `MAC Address Table`에서 프레임의 MAC주소를 찾는다.
3. MAC 주소에 대응하는 포트로 송신한다.

동시에 여러 프레임이 스위치에 도착해도 충돌이 발생하지 않는다.

#### 단점

스위치는 MAC 주소를 '학습'하고 포트와 MAC 주소의 대응표인 `MAC Address Table`를 만든다. 그런데 MAC 주소가 송신처의 프레임을 수신하기 전이여서 '학습하지 않은' 상태라면 MAC주소 필터링을 할 수 없어 허브와 마찬가지로 플러딩을 하게된다.

- 플러딩 경우

  1. 학습하지 않은 MAC 주소 프레임을 수신한 경우
  2. 브로드캐스트 수신처 프레임을 수신한 경우

### 버퍼링

목적지가 같은 프레임이 동시에 도달할 경우 나중에 도달한 프레임을 버퍼에 저장했다가 앞 프레임의 송신이 끝나면 송신한다.

#### 백 프레셔

버퍼가 가득 찬 경우 충돌을 전하는 신호 또는 PAUSE 프레임에 의해 더 이상의 송신을 중단 시킨다.

##### 전이중 이더넷

스위치는 충돌이 발생하지 않아 동시에 송신과 수신이 가능하다.
스위치는 전이중 통신을 사용하므로 반이중 통신을 사용하지 않는다.

- CSMA/CD (반이중 통신)

  누군가가 송신 중일 때는 데이터를 송신하지 않는다.

  자신이 송신 중일 때는 충돌을 막기 위해 다른 컴퓨터가 송신해 오지 않는다.
