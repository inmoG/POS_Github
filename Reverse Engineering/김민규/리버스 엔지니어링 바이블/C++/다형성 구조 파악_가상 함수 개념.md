# 다형성 구조 파악

## 가상 함수

- 가상함수는 일반적인 함수가 만들어지는 것과는 달리 별도의 테이블이 생성된다.
- 가상함수는 상속과 관련돼 있어서 테이블에 대한 정보를 생성자와 소멸자에서도 관리한다.
- 가상함수 테이블은 **.rdata** 섹션에 위치한다. 따라서 .rdata 섹션에 보관된 함수 포인터를 발견할 때는 가상 함수라 분석할 수 있다. 

### 가상 함수 추가
```{.cpp}
class Employee
{
    public :  
        int number;
        char name[128];
        long pay;
        Employee(); // 생성자
        ~Employee();
        void ShowData();
        void virtual Test(); // 가상 함수
}
```

### 생성자 및 소멸자 내부에 추가된 가상 함수 테이블 정보
```
push   ebp
mov    ebp, esp
push   ecx // 클래스 포인터 // 멤버 함수 void virtual Test()를 가리킴
mov    [ebp=4], ecx
mov    eax, [ebp-4]
mov    dword ptr [eax], offset off_4070C0 // 해당 멤버 변수에 가상 함수 테이블 정보를 저장
```
